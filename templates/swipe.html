{% extends "base.html" %}
{% block content %}
<div class="max-w-md mx-auto text-center mt-10">
    <h1 class="text-3xl font-bold mb-6">Find Your University</h1>
    
    <div id="card-container" class="relative w-full h-96">
        {% for uni in universities %}
        <!-- University Card -->
        <div class="uni-card absolute inset-0 bg-white rounded-2xl shadow-xl border border-gray-200 p-6 transform transition-all duration-300" data-id="{{ uni.id }}">
            <div class="h-48 bg-gray-200 rounded-xl mb-4 overflow-hidden">
                <img src="{{ uni.image_url or 'https://via.placeholder.com/400x300' }}" alt="Uni" class="w-full h-full object-cover">
            </div>
            <h2 class="text-2xl font-bold text-gray-800">{{ uni.name }}</h2>
            <p class="text-gray-500">{{ uni.country }}</p>
            
            <div class="flex justify-center gap-4 mt-8">
                <button onclick="swipe('rejected', {{ uni,id }}, this)" class="bg-red-100 text-red-600 p-4 rounded-full hover:bg-red-200 transition">
                    <i data-lucide="x" class="w-8 h-8"></i>
                </button>
                <button onclick="swipe('liked', {{ uni,id }}, this)" class="bg-green-100 text-green-600 p-4 rounded-full hover:bg-green-200 transition">
                    <i data-lucide="heart" class="w-8 h-8"></i>
                </button>
            </div>
        </div>
        {% else %}
        <div class="flex flex-col items-center justify-center h-full">
            <p class="text-gray-500 text-lg">No more universities to show!</p>
            <a href="/student/dashboard" class="mt-4 text-blue-600 font-bold hover:underline">Go to Dashboard</a>
        </div>
        {% endfor %}
    </div>
</div>

<script>
    function swipe(status, uniId, btn) {
        // 1. Send data to backend
        fetch('/api/swipe', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ status: status, uni_id: uniId })
        });

        // 2. Remove card from screen (Animation)
        const card = btn.closest('.uni-card');
        card.style.transform = status === 'liked' ? 'translateX(100vw) rotate(20deg)' : 'translateX(-100vw) rotate(-20deg)';
        card.style.opacity = '0';
        
        setTimeout(() => {
            card.remove();
        }, 300);
    }
</script>
{% endblock %}